/**
 * Minified by jsDelivr using Terser v5.39.0.
 * Original file: /npm/exifer@1.0.0-beta.2/dist/exifer.umd.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
!function(t,n){"object"==typeof exports&&"undefined"!=typeof module?module.exports=n():"function"==typeof define&&define.amd?define(n):(t=t||self).exifer=n()}(this,(function(){"use strict";const t={1:1,2:1,3:2,4:4,5:8,7:1,9:4,10:8,13:4},n={byte:1,ascii:2,short:3,long:4,rational:5,undefined:7,slong:9,srational:10,ifd:13},e={[n.byte]:(t,n,e)=>t.getUint8(n,e),[n.short]:(t,n,e)=>t.getUint16(n,e),[n.long]:(t,n,e)=>t.getUint32(n,e),[n.rational](t,e,i){return this[n.long](t,e,i)/this[n.long](t,e+4,i)},[n.slong]:(t,n,e)=>t.getInt32(n,e),[n.srational](t,e,i){return this[n.slong](t,e,i)/this[n.slong](t,e+4,i)},[n.ifd](t,e,i){return this[n.long](t,e,i)},[n.ascii](t,e,i){return this[n.byte](t,e,i)},[n.undefined](t,e,i){return this[n.byte](t,e,i)}},i=e=>t[n[e]],o=t=>t.map((t=>String.fromCharCode(t))).join(""),r=(t,n,e)=>o(f(t,{offset:n,count:e}));function f(i,{offset:o,type:r=n.byte,count:f,littleEndian:s}){const a=[];for(let n=0;n<f;n++)a.push(e[r](i,o,s)),o+=t[r];return a}function s(t,e=n.ascii){return e===n.ascii?(t=o(t)).endsWith("\0")?t.slice(0,-1):t:(1===t.length&&(t=t[0]),t)}const a=65505,c="Exif",u="http://ns.adobe.com/xap/1.0/\0",l="http://ns.adobe.com/xmp/extension/\0",g="Photoshop 3.0";function d(t,n){return t.getUint16(n,!1)===a&&r(t,n+4,4)===c&&0===t.getUint8(n+4+4,!1)}function m(t,n){return t.getUint16(n,!1)===a&&function(t,n){return r(t,n+4,29)===u}(t,n)}function h(t,n){return t.getUint16(n,!1)===a&&function(t,n){return r(t,n+4,35)===l}(t,n)}function y(t,n){return{dataOffset:t+33,length:n-31}}function p(t,n){return{dataOffset:t+79,length:n-77}}function U(t,n){return 65517===t.getUint16(n,!1)&&r(t,n+4,13)===g&&0===t.getUint8(n+4+13,!1)}function b(t,n){const e=t.getUint16(n,!1);return e>=65504&&e<=65519||65534===e||65472===e||65474===e||65476===e||65499===e||65501===e||65498===e}const w="GPSInfoIFDPointer",x="InteroperabilityIFDPointer",O={34853:{name:w},34665:{name:"ExifIFDPointer"},40965:{name:x},271:{name:"Make"},272:{name:"Model"},274:{name:"Orientation"},282:{name:"XResolution"},283:{name:"YResolution"},305:{name:"Software"},306:{name:"ModifyDate"},34855:{name:"ISO"},37385:{name:"Flash"},40962:{name:"PixelXDimension"},40963:{name:"PixelYDimension"}},P={2:{name:"GPSLatitude"},6:{name:"GPSAltitude"},4:{name:"GPSLongitude"}},E={592:{name:"Byline"},597:{name:"BylineTitle"},622:{name:"Credit"},628:{name:"CopyrightNotice"},630:{name:"Contact"}},I=943868237,A=12,L=t=>t%2!=0?1:0,S=t=>1028===t,D=(t,n)=>28!==t.getUint8(n);function j(t,n,{name:e,parse:i=t=>t,raw:r}){t=i(r?t:o(t)),n[e]=n[e]?Array.isArray(n[e])?[...n[e],t]:[n[e],t]:t}const C=i("short"),F=C+i("short"),k=F+i("long");function B(t,n,e,i,o){const r={},a=function*(t,n,e){const i=t.getUint16(n,e),o=12;for(let t=0;t<i;t++){const e=n+t*o+2;yield e}}(t,e,o);for(const e of a){const a=t.getUint16(e,o),c=t.getUint16(e+C,o),u={tag:a,type:c,count:t.getUint32(e+F,o),offset:e,tiffHeaderOffset:i,littleEndian:o},l=G(t,u);if(!n[a]||!N(t,l,u))continue;const g=f(t,{...u,offset:l}),{name:d,parse:m=t=>t,raw:h}=n[a];r[d]=m(h?g:s(g,c))}return r}function G(n,e){return t[e.type]*e.count<=i("long")?e.offset+k:e.tiffHeaderOffset+n.getUint32(e.offset+k,e.littleEndian)}function N(n,e,{tiffHeaderOffset:i,type:o,count:r}){return i+e+t[o]*r<=n.byteLength}const H="<x:xmpmeta";function M(t,n){const e=n.reduce(((t,n)=>t+n.length),0),i=new Uint8Array(e);let o=0;for(const e of n){const n=t.buffer.slice(e.dataOffset,e.dataOffset+e.length);i.set(new Uint8Array(n),o),o+=e.length}return new DataView(i.buffer)}const R={tiff:function(t,n,e={}){const i={...O,...e.exif},o={...P,...e.gps},r=function(t,n){const e=t.getUint16(n+0,!1);return 18761===e}(t,n),f=function(t,n,e){const i=t.getUint16(n+2,e);if(42!==i)throw new Error(`Invalid JPEG format: littleEndian ${e}, assertion: 0x${i}`);const o=t.getUint32(n+4,e);return n+o}(t,n,r);return function(t,n,e,i,o,r){const f=B(t,o,n,e,i);f[w]&&Object.assign(f,B(t,r,e+f[w],e,i));f[x]&&Object.assign(f,B(t,o,e+f[x],e,i));const s=t.getUint16(n,i),a=t.getUint32(n+2+12*s,i);0!==n&&Object.assign(f,B(t,o,e+a,e,i));return f}(t,f,n,r,i,o)},iptc:function(t,n,e={}){const i={...E,...e.iptc},{naaSize:o,dataOffset:r}=function(t,n){for(;n+12<=t.byteLength;){if(t.getUint32(n,!1)!==I)throw new Error("Not an IPTC resource block");const e=t.getUint16(n+4,!1),i=t.getUint16(n+10,!1);if(S(e))return{naaSize:i,dataOffset:n};n+=12+i+L(i)}throw new Error("No IPTC NAA resource block")}(t,n);return function(t,n,e,i){const o={};e+=A;const r=e+n;for(;e<r&&e<t.byteLength;){if(D(t,e))continue;const n=t.getUint16(e+1,!1),r=t.getUint16(e+3,!1),s=f(t,{offset:e+5,count:r});s&&i[n]&&j(s,o,i[n]),e+=5+r}return o}(t,o,r,i)},xmp:function(t,n){const e=function(t,n){if(!n.length)return[];const e=[M(t,n.slice(0,1))];n.length>1&&e.push(M(t,n.slice(1)));return e}(t,n).map((t=>r(t,0,t.byteLength))).join("\n"),i=e.indexOf(H),o=e.indexOf("x:xmpmeta>")+10;return{xmp:e.slice(i,o)}}};return async function(t,n={}){let e=await async function(t){let n;n="undefined"!=typeof File&&t instanceof File?await async function(t){const n=await new Promise((n=>{const e=new FileReader;e.onload=()=>n(e.result),e.readAsArrayBuffer(t)}));return n}(t):"undefined"!=typeof Buffer&&t instanceof Buffer?t.buffer:t;return new DataView(n)}(t),i={};for(const{type:t,offset:o}of function*(t){let n,e=2,i=[];if((t=>t.byteLength>=4&&(t=>{const n=18761===t.getUint16(0);return 42===t.getUint16(2,n)})(t))(t))return yield{type:"tiff",offset:0};if(!(t=>t.byteLength>=2&&65496===t.getUint16(0,!1))(t))throw new Error("Invalid image format");for(;e+4+5<=t.byteLength;){if(d(t,e)){n=t.getUint16(e+2,!1);let i=e+10;yield{type:"tiff",offset:i}}else if(m(t,e))n=t.getUint16(e+2,!1),i.push(y(e,n));else if(h(t,e))n=t.getUint16(e+2,!1),i.push(p(e,n));else if(U(t,e)){n=t.getUint16(e+2,!1);let i=e+18;yield{type:"iptc",offset:i}}else{if(!b(t,e))break;n=t.getUint16(e+2,!1)}e+=2+n}i.length&&(yield{type:"xmp",offset:i})}(e))n[`skip${t}`]||Object.assign(i,R[t](e,o,n.tags));return i}}));
//# sourceMappingURL=/sm/9db700c7d1474376ffe0209c362378a7d87c6fb7d1d3131f340516d11180c6b8.map